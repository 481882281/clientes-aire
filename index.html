<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Clientes Aire</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
*{box-sizing:border-box}
body{
 font-family:Arial, sans-serif;
 background:#f2f2f2;
 padding:15px;
 margin:0;
}
h1{
 text-align:center;
 font-size:22px;
 margin-bottom:10px;
}
.box{
 background:white;
 padding:15px;
 border-radius:14px;
 max-width:520px;
 margin:auto;
 box-shadow:0 4px 10px rgba(0,0,0,.08);
}
input,textarea,button{
 width:100%;
 padding:14px;
 margin-top:10px;
 font-size:16px;
 border-radius:10px;
 border:1px solid #ccc;
}
textarea{min-height:90px}
button{
 border:none;
 font-weight:bold;
}
button:active{opacity:.85}

#buscar{
 background:#fafafa;
}

ul{list-style:none;padding:0;margin:0}
li{
 background:#f0f0f0;
 padding:14px;
 margin-top:14px;
 border-radius:14px;
 font-size:15px;
 line-height:1.4;
}
.actions{
 display:flex;
 gap:10px;
 margin-top:12px;
}
.edit{
 background:#007bff;
 color:white;
}
.del{
 background:#e53935;
 color:white;
}

/* Optimizado iPhone */
@media (max-width:480px){
 h1{font-size:20px}
 input,textarea,button{font-size:17px}
 li{font-size:16px}
}
</style>
</head>

<body>

<h1>Clientes ‚Äì Aire Acondicionado</h1>

<div class="box" id="login">
<input type="password" id="pin" placeholder="PIN">
<button onclick="entrar()">Entrar</button>
</div>

<div class="box" id="app" style="display:none">

<input id="buscar" placeholder="üîç Buscar cliente..." oninput="cargar()">

<input id="nombre" placeholder="Nombre y apellido">
<input id="ubicacion" placeholder="Ubicaci√≥n">
<input id="equipo" placeholder="Marca y modelo">
<input id="telefono" placeholder="Tel√©fono">
<input type="date" id="fecha">
<textarea id="obs" placeholder="Observaciones"></textarea>

<button onclick="guardar()">Guardar cliente</button>

<ul id="lista"></ul>
</div>

<script>
const PIN="1234";
let editIndex=null;

// Reemplaza esto por tu enlace de SheetDB
const SHEETDB_URL = "TU_ENLACE_SHEETDB";

function entrar(){
 if(pin.value===PIN){
  login.style.display="none";
  app.style.display="block";
  cargar();
 } else alert("PIN incorrecto");
}

function guardar(){
 let cliente={
  nombre:nombre.value,
  ubicacion:ubicacion.value,
  equipo:equipo.value,
  telefono:telefono.value,
  fecha:fecha.value,
  obs:obs.value
 };

 fetch(SHEETDB_URL, {
   method: 'POST',
   headers: { 'Content-Type': 'application/json' },
   body: JSON.stringify({ data: cliente })
 })
 .then(res => {
   limpiar();
   cargar();
 });
}

function editar(i){
 // SheetDB no tiene index fijo, as√≠ que para editar lo ideal es borrar y volver a crear
 alert("Editar solo funciona desde tu Google Sheet por ahora.");
}

function borrar(i){
 if(!confirm("¬øBorrar este cliente?")) return;

 // SheetDB elimina usando el id del registro
 fetch(`${SHEETDB_URL}/${i+1}`, { method: 'DELETE' })
   .then(res => cargar());
}

function cargar(){
 lista.innerHTML="";
 let filtro=buscar.value.toLowerCase();

 fetch(SHEETDB_URL)
   .then(res => res.json())
   .then(arr => {
     arr.forEach((c,i)=>{
       let texto=(c.nombre+" "+c.ubicacion+" "+c.equipo+" "+c.telefono).toLowerCase();
       if(!texto.includes(filtro)) return;

       lista.innerHTML+=`
       <li>
        <b>${c.nombre}</b><br>
        üìç ${c.ubicacion}<br>
        ‚ùÑÔ∏è ${c.equipo}<br>
        üìû ${c.telefono}<br>
        üìÖ ${c.fecha || "‚Äî"}<br>
        üìù ${c.obs || ""}
        <div class="actions">
         <button class="edit" onclick="editar(${i})">Editar</button>
         <button class="del" onclick="borrar(${i})">Borrar</button>
        </div>
       </li>`;
     });
   });
}

function limpiar(){
 nombre.value="";
 ubicacion.value="";
 equipo.value="";
 telefono.value="";
 fecha.value="";
 obs.value="";
}
</script>

</body>
</html>
